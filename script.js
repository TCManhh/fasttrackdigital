document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".site-header"),t=document.querySelector(".modal"),l=document.querySelector(".modal-overlay"),a=document.querySelector(".modal-close"),i=document.getElementById("modal-image"),s=document.getElementById("search-overlay"),n=document.getElementById("search-input"),r=document.getElementById("search-overlay-input"),c=document.getElementById("overlay-search-results"),o=document.getElementById("close-search-btn"),d=document.getElementById("desktop-search-trigger"),h=document.getElementById("mobile-search-trigger"),g=document.getElementById("avatar-image"),m=document.getElementById("avatar-popup"),p=document.getElementById("avatar-popup-img"),v=document.querySelector(".avatar-popup-close"),b=()=>{t&&l&&(e.classList.add("is-hidden"),t.classList.add("active"),l.classList.add("active"),document.body.classList.add("modal-open"),document.dispatchEvent(new CustomEvent("modalHasOpened")))},u=()=>{t&&l&&(e.classList.remove("is-hidden"),t.classList.remove("active"),l.classList.remove("active"),document.body.classList.remove("modal-open"),setTimeout(()=>{t.classList.remove("image-view")},400),document.dispatchEvent(new CustomEvent("modalHasClosed")))};async function L(e){let{serviceData:l}=await import("./service-data.js"),a=l[e];a&&(t.classList.remove("image-view"),document.getElementById("modal-title").textContent=a.title,document.getElementById("modal-headline").innerHTML=a.headline,document.getElementById("modal-text").innerHTML=a.text,i.src=a.img||"",b(),E())}let f=async e=>{let t=e.target.value.toLowerCase().trim(),l=document.querySelector(".search-quick-links");if(c.innerHTML="",l&&(l.style.display=t.length>0?"none":"block"),t.length<2){c.style.display="none";return}let{serviceData:a}=await import("./service-data.js"),i=Object.keys(a).map(e=>({id:e,...a[e]})).filter(e=>{let l=e.headline.toLowerCase().replace(/<[^>]*>?/gm,""),a=e.text.toLowerCase().replace(/<[^>]*>?/gm,"");return l.includes(t)||a.includes(t)});i.length>0?(c.style.display="block",i.forEach(e=>{let t=document.createElement("div");t.className="result-item",t.innerHTML=`
                <img src="${e.searchImg||"./images/logo11.png"}" alt="${e.title}" loading="lazy">
                <div class="result-item-info">
                    <h4>${e.headline.replace(/<[^>]*>?/gm,"")}</h4>
                    <p>${e.title}</p>
                </div>`,t.addEventListener("click",()=>{B(),setTimeout(()=>L(e.id),400)}),c.appendChild(t)})):c.style.display="none"},$;r&&r.addEventListener("input",e=>{clearTimeout($),$=setTimeout(()=>{f(e)},150)});let y=e=>{e&&e.preventDefault(),s.classList.add("active"),document.body.style.overflow="hidden",setTimeout(()=>r.focus(),400)},B=()=>{s.classList.remove("active"),document.body.style.overflow="",r.value="",c.innerHTML="";let e=document.querySelector(".search-quick-links");e&&(e.style.display="block")};function E(){let e=t.querySelector(".faq-container");e&&e.addEventListener("click",function(e){let t=e.target.closest(".faq-question");if(!t)return;let l=t.nextElementSibling,a=t.classList.contains("active");this.querySelectorAll(".faq-question").forEach(e=>e.classList.remove("active")),this.querySelectorAll(".faq-answer").forEach(e=>e.style.maxHeight=null),a||(t.classList.add("active"),l.style.maxHeight=l.scrollHeight+"px")})}function w(){a&&a.addEventListener("click",u),l&&l.addEventListener("click",u),t&&t.addEventListener("click",e=>{e.target.closest(".modal-content")&&e.stopPropagation()}),document.querySelectorAll(".card").forEach(e=>{e.addEventListener("click",()=>{let t=e.dataset.id;t&&L(t)})}),d&&d.addEventListener("click",y),h&&h.addEventListener("click",y),n&&n.addEventListener("click",y),o&&o.addEventListener("click",B),s&&s.addEventListener("click",e=>{e.target===s&&B()}),window.addEventListener("keydown",e=>{"Escape"===e.key&&s.classList.contains("active")&&B()});let i=document.querySelector(".search-quick-links");i&&i.addEventListener("click",e=>{let t=e.target.closest("a"),l=t?t.dataset.id:null;l&&(e.preventDefault(),B(),setTimeout(()=>L(l),400))}),g&&m&&p&&v&&(g.addEventListener("click",()=>{let e=g.getAttribute("src");p.setAttribute("src",e),m.classList.add("show")}),v.addEventListener("click",()=>{m.classList.remove("show")}),m.addEventListener("click",e=>{"avatar-popup"===e.target.id&&m.classList.remove("show")}));let r=document.getElementById("category-trigger"),c=document.getElementById("category-overlay"),b=document.getElementById("category-menu"),f=document.getElementById("category-close-btn"),$=()=>{e.classList.add("is-hidden"),c.classList.add("active"),b.classList.add("active"),document.body.classList.add("modal-open")},E=()=>{e.classList.remove("is-hidden"),c.classList.remove("active"),b.classList.remove("active"),document.body.classList.remove("modal-open")};r&&r.addEventListener("click",e=>{e.preventDefault(),$()}),c&&c.addEventListener("click",E),f&&f.addEventListener("click",E),b&&b.addEventListener("click",e=>{let t=e.target.closest("a");if(!t)return;let l=t.dataset.id;l?(e.preventDefault(),E(),setTimeout(()=>L(l),50)):E()});let w=document.querySelector(".hamburger-btn"),T=document.querySelector(".main-nav");w&&T&&(w.addEventListener("click",()=>{T.classList.toggle("is-open")}),T.addEventListener("click",e=>{e.target.closest("a")&&T.classList.remove("is-open")})),document.querySelectorAll('a[href^="#"]:not(.faq-nav-link)').forEach(e=>{e.addEventListener("click",function(e){if(this.getAttribute("href").length<=1)return;e.preventDefault();let t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})});let _=document.querySelectorAll(".card, .section-title, .owner-profile"),q=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-visible"),q.unobserve(e.target))})},{threshold:.1});_.forEach(e=>q.observe(e))}function T(){let e=document.querySelectorAll(".copy-faq-btn");e.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();let l=e.dataset.targetId,a=window.location.origin+window.location.pathname,i=`${a}#${l}`;navigator.clipboard.writeText(i).then(()=>{let t=e.innerText;e.innerText="Đ\xe3 ch\xe9p link!",e.classList.add("copied"),setTimeout(()=>{e.innerText=t,e.classList.remove("copied")},2500)}).catch(e=>{console.error("Lỗi sao ch\xe9p link: ",e),alert("Kh\xf4ng thể sao ch\xe9p li\xean kết. Vui l\xf2ng thử lại.")})})})}function _(e){if(!e||e.length<=1)return;let t=document.querySelector(".faq-nav"),l=document.querySelector(".faq-content");if(!t||!l)return;let a=l.querySelector(e),i=t.querySelector(`.faq-nav-link[href="${e}"]`);a&&i&&(t.querySelector(".active")?.classList.remove("active"),l.querySelector(".active")?.classList.remove("active"),i.classList.add("active"),a.classList.add("active"),setTimeout(()=>{a.scrollIntoView({behavior:"smooth",block:"start"})},100))}function q(e,l){e.addEventListener("click",function(e){let t=e.target.closest(".faq-nav-link");if(!t)return;e.preventDefault();let l=t.getAttribute("href");window.history.pushState?window.history.pushState(null,null,l):window.location.hash=l,_(l)}),l.addEventListener("click",e=>{"IMG"===e.target.tagName&&e.target.closest(".faq-article")&&(e.stopPropagation(),t&&i&&(t.classList.add("image-view"),i.src=e.target.src,b()))}),T(),window.location.hash&&_(window.location.hash),window.addEventListener("popstate",()=>{window.location.pathname.includes("faq.html")&&window.location.hash&&_(window.location.hash)})}function k(){let e=document.querySelector(".bill-carousel-track");if(!e)return;let l=document.querySelector(".bill-slider"),a=document.querySelector(".bill-counter"),s=[{src:"./images_bill_thanh_toan/0329DSMQZL.webp",alt:"Bill 46"},{src:"./images_bill_thanh_toan/0327DSMQZL.webp",alt:"Bill 45"},{src:"./images_bill_thanh_toan/0326YTVTFB.webp",alt:"Bill 44"},{src:"./images_bill_thanh_toan/0326YTNCFB.webp",alt:"Bill 43"},{src:"./images_bill_thanh_toan/0323YTTLFB.webp",alt:"Bill 42"},{src:"./images_bill_thanh_toan/0319YTTVFB.webp",alt:"Bill 41"},{src:"./images_bill_thanh_toan/0319YTQVFB.webp",alt:"Bill 40"},{src:"./images_bill_thanh_toan/0319YTMTFB.webp",alt:"Bill 39"},{src:"./images_bill_thanh_toan/0318YTVQFB.webp",alt:"Bill 38"},{src:"./images_bill_thanh_toan/0318YTTHZL.webp",alt:"Bill 37"},{src:"./images_bill_thanh_toan/0317YTTHFB.webp",alt:"Bill 36"},{src:"./images_bill_thanh_toan/0317YTDHFB.webp",alt:"Bill 35"},{src:"./images_bill_thanh_toan/0316YTMĐFB.webp",alt:"Bill 34"},{src:"./images_bill_thanh_toan/0316YTBĐFB.webp",alt:"Bill 33"},{src:"./images_bill_thanh_toan/0315YTTHFB.webp",alt:"Bill 32"},{src:"./images_bill_thanh_toan/0315YTNTFB.webp",alt:"Bill 31"},{src:"./images_bill_thanh_toan/0313YTCAZL.webp",alt:"Bill 30"},{src:"./images_bill_thanh_toan/0311YTVBZL.webp",alt:"Bill 29"},{src:"./images_bill_thanh_toan/0311YTTVFB.webp",alt:"Bill 28"},{src:"./images_bill_thanh_toan/0311YTNHZL.webp",alt:"Bill 27"},{src:"./images_bill_thanh_toan/0311YTDMZL.webp",alt:"Bill 26"},{src:"./images_bill_thanh_toan/0310YTTNFB.webp",alt:"Bill 25"},{src:"./images_bill_thanh_toan/0310DSDAFB.webp",alt:"Bill 24"},{src:"./images_bill_thanh_toan/0309YTQHFB.webp",alt:"Bill 23"},{src:"./images_bill_thanh_toan/0308YTTAFB.webp",alt:"Bill 22"},{src:"./images_bill_thanh_toan/0308YTMTFB.webp",alt:"Bill 21"},{src:"./images_bill_thanh_toan/0308YTDVFB.webp",alt:"Bill 20"},{src:"./images_bill_thanh_toan/0308DSMTZL.webp",alt:"Bill 19"},{src:"./images_bill_thanh_toan/0306YTVPFB.webp",alt:"Bill 18"},{src:"./images_bill_thanh_toan/0305YTNLFB.webp",alt:"Bill 17"},{src:"./images_bill_thanh_toan/0305YTAVFB.webp",alt:"Bill 16"},{src:"./images_bill_thanh_toan/0305DSĐHFB.webp",alt:"Bill 15"},{src:"./images_bill_thanh_toan/0302YTVHZL.webp",alt:"Bill 14"},{src:"./images_bill_thanh_toan/0302DSATFB.webp",alt:"Bill 13"},{src:"./images_bill_thanh_toan/0227YTTFB.webp",alt:"Bill 12"},{src:"./images_bill_thanh_toan/0223YTTLFB.webp",alt:"Bill 11"},{src:"./images_bill_thanh_toan/0222YTATZL.webp",alt:"Bill 10"},{src:"./images_bill_thanh_toan/0219YTNTFB.webp",alt:"Bill 9"},{src:"./images_bill_thanh_toan/0218YTNCFB.webp",alt:"Bill 8"},{src:"./images_bill_thanh_toan/0216YTNTFB.webp",alt:"Bill 7"},{src:"./images_bill_thanh_toan/0215YTTHFB.webp",alt:"Bill 6"},{src:"./images_bill_thanh_toan/0215YTTNZL.webp",alt:"Bill 5"},{src:"./images_bill_thanh_toan/0204DSLHZL.webp",alt:"Bill 4"},{src:"./images_bill_thanh_toan/0203YTQPZL.webp",alt:"Bill 3"},{src:"./images_bill_thanh_toan/0202DSĐHFB.webp",alt:"Bill 2"},{src:"./images_bill_thanh_toan/0128YTVHZL.webp",alt:"Bill 1"}],n=[],r=0,c;if(s.slice(0,5).forEach(t=>{let l=document.createElement("div");l.className="bill-carousel-item";let a=document.createElement("img");a.src=t.src,a.alt=t.alt,a.loading="lazy",l.appendChild(a),e.appendChild(l)}),(n=Array.from(e.children)).length<=1)return;function o(t){if(t<s.length&&t>=n.length){for(let l=n.length;l<=t;l++){if(!s[l])continue;let a=s[l],i=document.createElement("div");i.className="bill-carousel-item";let r=document.createElement("img");r.src=a.src,r.alt=a.alt,r.loading="lazy",i.appendChild(r),e.appendChild(i)}n=Array.from(e.children)}}function d(t){if(t<0||t>=s.length)return;o(t);let i=n[t];if(i){let c=(e.clientWidth-i.clientWidth)/2,d=i.offsetLeft-c;e.scrollTo({left:d,behavior:"smooth"}),r=t,function e(t){if(l){l.value=t;let i=s.length>1?t/(s.length-1)*100:0;l.style.setProperty("--progress",`${i}%`)}a&&(a.textContent=`${t+1} / ${s.length}`)}(t),n.forEach((e,l)=>e.classList.toggle("active",l===t))}o(t+5)}function h(){g(),c=setInterval(()=>{d((r+1)%s.length)},2e3)}function g(){clearInterval(c)}let m;e.addEventListener("scroll",()=>{g(),window.clearTimeout(m),m=setTimeout(()=>{let t=e.getBoundingClientRect(),l=t.left+t.width/2,a=-1,i=1/0;n.forEach((e,t)=>{let s=e.getBoundingClientRect(),n=s.left+s.width/2,r=Math.abs(n-l);r<i&&(i=r,a=t)}),-1!==a&&r!==a&&d(a),h()},150)}),l&&(l.max=s.length-1,l.addEventListener("input",()=>{g(),d(parseInt(l.value,10))}),l.addEventListener("change",h)),e.addEventListener("click",e=>{let l=e.target.closest(".bill-carousel-item img");l&&(t.classList.add("image-view"),i.src=l.src,b())}),document.addEventListener("modalHasOpened",g),document.addEventListener("modalHasClosed",h);let p=n[0];if(p){let v=(e.clientWidth-p.clientWidth)/2;e.style.paddingLeft=`${v}px`,e.style.paddingRight=`${v}px`}setTimeout(()=>{d(0),h()},100)}function S(){e&&window.addEventListener("scroll",()=>{let t=window.pageYOffset||document.documentElement.scrollTop;t>20?e.classList.add("scrolled"):e.classList.remove("scrolled")})}function Y(){let e=document.querySelectorAll('.main-nav a[href*="#"]'),t=document.querySelector('.main-nav a[href="index.html"]'),l=Array.from(e).map(e=>{let t=e.getAttribute("href").split("#")[1];if(t)return document.getElementById(t)}).filter(Boolean);if(0===l.length)return;let a=new IntersectionObserver(e=>{let a=!1;e.forEach(e=>{if(e.isIntersecting){a=!0;let t=e.target.getAttribute("id");document.querySelectorAll(".main-nav a").forEach(e=>e.classList.remove("active-page"));let l=document.querySelector(`.main-nav a[href*="#${t}"]`);l&&l.classList.add("active-page")}}),!a&&window.scrollY<l[0].offsetTop-150&&(document.querySelectorAll(".main-nav a").forEach(e=>e.classList.remove("active-page")),t&&t.classList.add("active-page"))},{rootMargin:"-150px 0px -50% 0px"});l.forEach(e=>a.observe(e))}function F(){let e=document.querySelectorAll(".filter-btn"),t=document.querySelectorAll(".card");e.length&&t.length&&e.forEach(e=>{e.addEventListener("click",()=>{document.querySelector(".filter-btn.active").classList.remove("active"),e.classList.add("active");let l=e.dataset.filter;t.forEach(e=>{let t=e.dataset.category;"all"===l||l===t?e.classList.remove("hide"):e.classList.add("hide")})})})}F(),w(),S(),Y();let I=document.querySelector(".bill-showcase");I&&k();let A=document.querySelector(".pricing-grid");A&&A.addEventListener("click",e=>{let t=e.target.closest(".price-card");if(t){let l=t.dataset.id;l&&L(l)}});let H=document.querySelector(".faq-nav"),x=document.querySelector(".faq-content");H&&x&&q(H,x)});